This implementation directly follows the algorithm and does not contain any optimizations.
